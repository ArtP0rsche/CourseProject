@model IEnumerable<CourseProject.DataModels.Request>

@{
    ViewData["Title"] = "Поданные заявки";
}

<head>
    <meta charset="UTF-8">
    <title>Таблица заявок</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #014898;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .status-cell {
            position: relative;
        }

        .status-select {
            width: 100%;
            padding: 8px;
            border: 2px solid transparent;
            border-radius: 6px;
            background-color: transparent;
            transition: border-color 0.3s;
        }

        .status-select:focus {
            border-color: #014898;
            outline: none;
            background-color: #fff;
        }
    </style>
</head>
<body>
    <div style="display: flex;">
        <div style="width: 20%; padding: 10px;">
            <div class="nav-item">
                <a asp-controller="Users" asp-action="Edit" asp-route-id="@Convert.ToInt32(Context.Session.GetString("UserId"))" class="item"><i class="fa fa-user-circle-o"></i> Личный кабинет</a>
            </div>
            <div class="nav-item">
                <a asp-controller="Events" asp-action="Index" class="item"><i class="fa fa-calendar"></i> Мероприятия</a>
            </div>
            <div class="nav-item">
                <a asp-controller="Vacancies" asp-action="Index" class="item"><i class="fa fa-address-card"></i> Вакансии</a>
            </div>
            @if (Context.Session.GetString("UserRole") == "Администратор")
            {
                <div class="nav-item">
                    <a asp-action="Index" class="item"><i class="fa fa-envelope"></i> Заявки</a>
                </div>
            }
        </div>
        <div style="width: 80%; padding: 10px;">
            <table>
                <thead>
                    <tr>
                        <th>Мероприятие</th>
                        <th>Содержимое заявки</th>
                        <th>Учреждение</th>
                        <th>Количество человек</th>
                        <th style="width: 250px">Статус заявки</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.Event.Title</td>
                            <td>@item.Content</td>
                            <td>@item.Institution</td>
                            <td>@item.PeopleNumber</td>
                            <td>
                                <form asp-controller="Requests" asp-action="UpdateStatus" style="display: flex; justify-content: space-between">
                                    <input type="hidden" name="Id" value="@item.RequestId" />
                                    <select name="status" class="status-select">
                                        @foreach (var status in (List<string>)ViewBag.StatusOptions)
                                        {
                                            <option value="@status" selected="@(status == item.Status ? "selected" : null)">
                                                @status
                                            </option>
                                        }
                                    </select>
                                    <button type="submit" class="btn" title="Сохранить"><i class="fa fa-floppy-o"></i></button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</body>