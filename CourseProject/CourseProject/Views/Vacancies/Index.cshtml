@model IEnumerable<CourseProject.DataModels.Vacancy>

@{
    ViewData["Title"] = "Вакансии";
}

<style>
    .card:hover {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
    }
</style>

<div style="display: flex;">
    <div style="width: 20%; padding: 10px;">
        <div class="nav-item">
            @if (string.IsNullOrEmpty(Context.Session.GetString("UserRole")))
            {
                <a asp-controller="Auth" asp-action="Login" class="item"><i class="fa fa-user-circle-o"></i> Личный кабинет</a>
            }
            else
            {
                <a asp-controller="Users" asp-action="Edit" asp-route-id="@Convert.ToInt32(Context.Session.GetString("UserId"))" class="item"><i class="fa fa-user-circle-o"></i> Личный кабинет</a>
            }
        </div>
        <div class="nav-item">
            <a asp-controller="Events" asp-action="Index" class="item"><i class="fa fa-calendar"></i> Мероприятия</a>
        </div>
        <div class="nav-item">
            <a asp-action="Index" class="item"><i class="fa fa-address-card"></i> Вакансии</a>
        </div>
        @if (Context.Session.GetString("UserRole") == "Администратор")
        {
            <div class="nav-item">
                <a asp-controller="Requests" asp-action="Index" class="item"><i class="fa fa-envelope"></i> Заявки</a>
            </div>
        }
    </div>
    <div style="width: 80%; padding: 10px; display: flex">
        <div style="width: 30%; padding: 0 5px">
            @foreach (var item in Model)
            {
                <div class="card" style="border: 2px solid #014898; border-radius: 8px; padding: 10px; align-content: space-evenly; margin: 5px 0"
                     data-id="@item.VacancyId" data-title="@item.Title" data-company="@item.Company" data-min-salary="@item.MinSalary" data-max-salary="@item.MaxSalary"
                     data-updated-on="@item.UpdatedOn" data-region="@item.Region" data-address="@item.Address" data-responsibility="@item.Responsibility"
                     data-requirements="@item.Requirements" data-information="@item.JobInformation">
                    <div style="font-weight: bold; font-size: 18px">@Html.DisplayFor(modelItem => item.Title)</div>
                    @if (!string.IsNullOrEmpty(item.Workplace))
                    {
                        <div style="font-size: 16px">@Html.DisplayFor(modelItem => item.Workplace)</div>
                    }
                    else
                    {
                        <div style="font-size: 16px">@Html.DisplayFor(modelItem => item.Company)</div>
                    }
                    <div style="font-size: 13px">@Html.DisplayFor(modelItem => item.Region)</div>
                    @if (item.MinSalary == null)
                    {
                        <div style="font-size: 15px">До @Html.DisplayFor(modelItem => item.MaxSalary) руб.</div>
                    }
                    else if (item.MaxSalary == null)
                    {
                        <div style="font-size: 15px">От @Html.DisplayFor(modelItem => item.MinSalary) руб.</div>
                    }
                    else
                    {
                        <div style="font-size: 15px">@item.MinSalary-@item.MaxSalary руб.</div>
                    }
                    <div style="font-size: 12px">Обновлено: @Html.DisplayFor(modelItem => item.UpdatedOn)</div>
                </div>
            }
        </div>
        <div style="width: 70%; padding: 0 5px">
            <div class="content" style="display: none; border: 2px solid #014898; border-radius: 8px; padding: 10px; align-content: space-evenly; margin: 5px 0"></div>
            <div class="info" style="display: none; border: 2px solid #014898; border-radius: 8px; padding: 10px; align-content: space-evenly">

            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.card');
    const detailsContent = document.querySelector('.content');
    const detailsInfo = document.querySelector('.info');

    cards.forEach(card => {
        card.addEventListener('click', function() {
            const title = this.dataset.title;
            const region = this.dataset.region;
            const company = this.dataset.company;
            const minSalary = this.dataset.minSalary;
            const maxSalary = this.dataset.maxSalary;
            const updatedOn = this.dataset.updatedOn;
            const address = this.dataset.address;
            const responsibility = this.dataset.responsibility;
            const requirements = this.dataset.requirements;
            const jobInfo = this.dataset.information;

            let salaryText = '';
            if (!minSalary && maxSalary) {
                salaryText = `До ${maxSalary} руб.`;
            } else if (minSalary && !maxSalary) {
                salaryText = `От ${minSalary} руб.`;
            } else if (minSalary && maxSalary) {
                salaryText = `${minSalary}–${maxSalary} руб.`;
            }

            let infoHTML = '';

            if (responsibility && responsibility.trim() !== '') {
                const resParts = responsibility
                    .split('.')
                    .map(part => part.trim())
                    .filter(part => part !== '');

                infoHTML += `
                    <div style="
                        font-size: 20px;
                        font-weight: bold;
                        margin: 6px 0;
                        line-height: 1.4;
                    ">
                        Должностные обязанности:
                    </div>
                `;

                resParts.forEach(part => {
                    infoHTML += `
                        <div style="
                            font-size: 18px;
                            margin: 6px 0;
                            line-height: 1.4;
                        ">
                            ${part}.
                        </div>
                    `;
                });
            }

            if (requirements && requirements.trim() !== '') {
                const reqParts = requirements
                    .split('.')
                    .map(part => part.trim())
                    .filter(part => part !== '');

                infoHTML += `
                    <hr />
                    <div style="
                        font-size: 20px;
                        font-weight: bold;
                        margin: 6px 0;
                        line-height: 1.4;
                    ">
                        Требования к кандидату:
                    </div>
                `;

                reqParts.forEach(part => {
                    infoHTML += `
                        <div style="
                            font-size: 18px;
                            margin: 6px 0;
                            line-height: 1.4;
                        ">
                            ${part}.
                        </div>
                    `;
                });
            }

            if (jobInfo && jobInfo.trim() !== '') {
                const infoParts = jobInfo
                    .split('.')
                    .map(part => part.trim())
                    .filter(part => part !== '');

                infoHTML += `
                    <hr />
                    <div style="
                        font-size: 20px;
                        font-weight: bold;
                        margin: 6px 0;
                        line-height: 1.4;
                    ">
                        Данные по вакансии:
                    </div>
                `;

                infoParts.forEach(part => {
                    infoHTML += `
                        <div style="
                            font-size: 18px;
                            margin: 6px 0;
                            line-height: 1.4;
                        ">
                            ${part}.
                        </div>
                    `;
                });

                infoHTML += `
                        <div style="
                            font-size: 18px;
                            margin: 6px 0;
                            line-height: 1.4;
                        ">
                            Адрес места работы: ${region}, ${address}.
                        </div>
                    `;
            }

            const detailsHTML = `
                <div style="font-weight: bold; font-size: 22px;">${title}</div>
                <div style="font-size: 19px; margin: 8px 0;">${company} · ${region}</div>
                <div style="font-size: 17px; margin: 8px 0;">${salaryText}</div>
                <div style="font-size: 12px; text-align: right; margin-top: 15px;">
                    Обновлено: ${updatedOn}
                </div>
            `;

            detailsContent.innerHTML = detailsHTML;
            detailsContent.style.display = 'block';

            detailsInfo.innerHTML = infoHTML;
            detailsInfo.style.display = 'block';
        });
    });
});
</script>

@* @foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Title)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Company)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Workplace)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Region)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.MinSalary)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.MaxSalary)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Address)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.UpdatedOn)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Responsibility)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Requirements)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.JobInformation)
            </td>
        </tr>
}
    </tbody>
</table> *@
